<!doctype html>
<html lang="kk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EduPhysics AI ‚Ä¢ –¢“±—Ä–∞“õ—Ç—ã –º–∞–≥–Ω–∏—Ç—Ç–µ—Ä (“ö–ë –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞)</title>
  <style>
    /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       –î–ò–ó–ê–ô–ù (–±–∞—Å“õ–∞—à–∞): ‚ÄúNeon Paper + Grid‚Äù
       ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    :root{
      --bg:#070a12;
      --paper:#0c1222;
      --paper2:#0a1020;
      --stroke:rgba(255,255,255,.10);
      --stroke2:rgba(255,255,255,.06);
      --text:#edf3ff;
      --muted:#a9b7d6;

      --a:#7c3aed; /* violet */
      --b:#22d3ee; /* cyan */
      --c:#fb7185; /* rose */
      --ok:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;

      --shadow: 0 18px 60px rgba(0,0,0,.50);
      --radius: 18px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background:
        radial-gradient(900px 500px at 15% 10%, rgba(34,211,238,.14), transparent 55%),
        radial-gradient(900px 550px at 85% 15%, rgba(124,58,237,.16), transparent 55%),
        radial-gradient(900px 600px at 70% 85%, rgba(251,113,133,.10), transparent 60%),
        linear-gradient(180deg, #070a12, #050711);
      overflow-x:hidden;
    }

    /* subtle grid */
    body::before{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      background-image:
        linear-gradient(to right, rgba(255,255,255,.04) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(255,255,255,.04) 1px, transparent 1px);
      background-size: 42px 42px;
      opacity:.25;
      mask-image: radial-gradient(ellipse at 50% 30%, rgba(0,0,0,1) 0%, rgba(0,0,0,.2) 60%, transparent 100%);
    }

    header{
      position:sticky; top:0; z-index:10;
      backdrop-filter: blur(12px);
      background: rgba(7,10,18,.70);
      border-bottom:1px solid var(--stroke2);
    }
    .topbar{
      max-width:1120px;
      margin:0 auto;
      padding:16px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .brand{
      display:flex; flex-direction:column; gap:2px;
    }
    .brand b{
      font-size:14px; letter-spacing:.08em; text-transform:uppercase;
      background: linear-gradient(90deg, var(--b), var(--a));
      -webkit-background-clip:text; background-clip:text;
      -webkit-text-fill-color:transparent;
    }
    .brand span{font-size:12px;color:var(--muted)}
    .nav{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
    }
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:9px 12px;
      border:1px solid var(--stroke);
      border-radius:999px;
      background: rgba(12,18,34,.55);
      color:var(--text);
      text-decoration:none;
      font-weight:700;
      font-size:12px;
      letter-spacing:.04em;
      transition:.18s;
    }
    .chip:hover{transform:translateY(-1px); border-color:rgba(34,211,238,.35)}
    .chip .dot{
      width:8px;height:8px;border-radius:50%;
      background: radial-gradient(circle at 30% 30%, var(--b), var(--a));
      box-shadow: 0 0 18px rgba(34,211,238,.35);
    }

    main{
      max-width:1120px;
      margin:0 auto;
      padding:16px;
      display:grid;
      gap:14px;
    }

    .hero{
      border-radius: var(--radius);
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(12,18,34,.85), rgba(10,16,32,.72));
      box-shadow: var(--shadow);
      padding:16px;
      position:relative;
      overflow:hidden;
    }
    .hero::after{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(600px 220px at 20% 0%, rgba(34,211,238,.18), transparent 65%),
                  radial-gradient(700px 260px at 90% 20%, rgba(124,58,237,.16), transparent 70%);
      pointer-events:none;
    }
    .hero h1{
      margin:0;
      font-size: clamp(18px, 2.6vw, 28px);
      letter-spacing:.02em;
    }
    .hero p{
      margin:8px 0 0;
      color: var(--muted);
      line-height:1.5;
      font-size:13px;
      max-width: 85ch;
    }

    .grid{
      display:grid; grid-template-columns: 1fr; gap:14px;
    }
    @media (min-width:980px){
      .grid{grid-template-columns: 1.25fr .75fr;}
    }

    .card{
      border-radius: var(--radius);
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(12,18,34,.92), rgba(10,16,32,.82));
      box-shadow: var(--shadow);
      padding:14px;
    }
    .card h2{
      margin:0 0 10px;
      font-size:14px;
      letter-spacing:.08em;
      text-transform:uppercase;
      color: rgba(237,243,255,.95);
    }
    .muted{color:var(--muted); font-size:13px; line-height:1.55}
    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .hr{height:1px;background:var(--stroke2); margin:12px 0}

    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:7px 10px;
      border-radius:999px;
      border:1px solid var(--stroke);
      background: rgba(7,10,18,.35);
      color: var(--muted);
      font-size:12px;
    }
    .tag{
      display:inline-flex; align-items:center;
      padding:6px 10px;
      border-radius:999px;
      font-size:12px;
      font-weight:800;
      letter-spacing:.04em;
      border:1px solid var(--stroke);
      background: rgba(7,10,18,.35);
    }
    .tag.ok{color:var(--ok); border-color:rgba(52,211,153,.35)}
    .tag.warn{color:var(--warn); border-color:rgba(251,191,36,.35)}
    .tag.bad{color:var(--bad); border-color:rgba(251,113,133,.35)}

    .btn{
      cursor:pointer;
      border:1px solid var(--stroke);
      background: rgba(7,10,18,.35);
      color: var(--text);
      padding:10px 12px;
      border-radius: 14px;
      font-weight:800;
      font-size:12px;
      letter-spacing:.05em;
      text-transform:uppercase;
      transition:.18s;
    }
    .btn:hover{transform:translateY(-1px); border-color: rgba(34,211,238,.35)}
    .btn.primary{
      border:0;
      background: linear-gradient(90deg, var(--b), var(--a));
      color:#031018;
      box-shadow: 0 12px 30px rgba(34,211,238,.10);
    }
    .btn.danger{
      border:0;
      background: linear-gradient(90deg, var(--c), #f97316);
      color:#180607;
    }

    .q{
      border:1px solid var(--stroke);
      background: rgba(7,10,18,.28);
      border-radius: 16px;
      padding:12px;
      margin:10px 0;
    }
    .q b{color:rgba(237,243,255,.95)}
    label{
      display:block;
      margin:7px 0;
      font-size:13px;
      color: rgba(237,243,255,.90);
    }
    input[type="text"], textarea, select{
      width:100%;
      padding:10px 11px;
      border-radius: 14px;
      border:1px solid var(--stroke);
      background: rgba(7,10,18,.30);
      color: var(--text);
      outline:none;
    }
    textarea{min-height:90px; resize:vertical}

    .scoreBig{font-size:30px;font-weight:900; letter-spacing:.02em}
    .badge{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:16px;
      border:1px dashed rgba(255,255,255,.18);
      background: rgba(7,10,18,.25);
    }
    .badges{display:grid; gap:10px}
    .small{font-size:12px;color:var(--muted)}
    .hint{font-size:12px;color:var(--muted); margin-top:6px}

    /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       –ö–†–û–°–°–í–û–†–î (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π) ‚Äî —Å—Ç–∏–ª—å —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å —Ç–µ–º–æ–π
       ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    .cw-wrap{
      border-radius: var(--radius);
      border:1px solid var(--stroke);
      background: rgba(7,10,18,.22);
      padding:14px;
    }
    .cw-head{
      display:flex; align-items:flex-end; justify-content:space-between; gap:12px;
      flex-wrap:wrap;
    }
    .cw-head h3{
      margin:0;
      font-size:14px;
      letter-spacing:.08em;
      text-transform:uppercase;
    }
    .cw-grid{
      display:inline-grid;
      gap:1px;
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.12);
      border-radius: 10px;
      overflow:hidden;
      margin-top:12px;
    }
    .cw-cell{
      width:34px; height:34px;
      background: rgba(7,10,18,.55);
      position:relative;
    }
    .cw-cell.active{background: rgba(12,18,34,.88)}
    .cw-cell .num{
      position:absolute; top:2px; left:3px;
      font-size:9px;
      color: rgba(34,211,238,.9);
      font-weight:900;
      pointer-events:none;
    }
    .cw-cell input{
      width:100%; height:100%;
      border:0; outline:0;
      background: transparent;
      color: var(--text);
      text-transform:uppercase;
      text-align:center;
      font-weight:900;
      font-size:14px;
      padding-top:8px;
      caret-color: var(--b);
    }
    .cw-cell.correct input{color: var(--ok)}
    .cw-cell.wrong input{color: var(--bad)}
    .cw-cell.highlight{background: rgba(34,211,238,.12)}
    .cw-cell.selected{background: rgba(124,58,237,.18)}

    .cw-cols{
      display:flex; gap:12px; flex-wrap:wrap; margin-top:12px;
    }
    .cw-col{
      flex:1 1 280px;
      border:1px solid var(--stroke2);
      border-radius: 14px;
      background: rgba(12,18,34,.55);
      padding:12px;
    }
    .cw-col h4{
      margin:0 0 10px;
      font-size:12px;
      letter-spacing:.12em;
      text-transform:uppercase;
      color: rgba(251,191,36,.95);
    }
    .cw-clue{
      display:flex; gap:8px;
      padding:7px 6px;
      border-radius: 10px;
      border:1px solid transparent;
      cursor:pointer;
      transition:.15s;
    }
    .cw-clue:hover{border-color:rgba(34,211,238,.25); background: rgba(7,10,18,.25)}
    .cw-clue .n{min-width:22px; color: rgba(34,211,238,.95); font-weight:900}
    .cw-clue .t{color: rgba(237,243,255,.85); font-size:13px; line-height:1.35}

    .cw-actions{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px}
    .cw-result{margin-top:10px; font-weight:900; letter-spacing:.02em}
    .cw-result.ok{color: var(--ok)}
    .cw-result.warn{color: var(--warn)}

    @media (max-width:640px){
      .cw-cell{width:28px;height:28px}
      .cw-cell input{font-size:12px; padding-top:6px}
      .cw-cell .num{font-size:7px}
    }
  </style>
</head>

<body>
<header>
  <div class="topbar">
    <div class="brand">
      <b>EduPhysics AI</b>
      <span>“ö–ë –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Å—ã ‚Ä¢ 8-—Å—ã–Ω—ã–ø ‚Ä¢ –¢“±—Ä–∞“õ—Ç—ã –º–∞–≥–Ω–∏—Ç—Ç–µ—Ä</span>
    </div>
    <nav class="nav">
      <a class="chip" href="#tasks"><span class="dot"></span>–¢–µ—Å—Ç + “ö–ë</a>
      <a class="chip" href="#crossword"><span class="dot"></span>–ö—Ä–æ—Å—Å–≤–æ—Ä–¥</a>
      <a class="chip" href="reflection.html"><span class="dot"></span>–†–µ—Ñ–ª–µ–∫—Å–∏—è –±–µ—Ç—ñ ‚Üí</a>
    </nav>
  </div>
</header>

<main>
  <section class="hero">
    <h1>–¢“±—Ä–∞“õ—Ç—ã –º–∞–≥–Ω–∏—Ç—Ç–µ—Ä: –∞–≤—Ç–æ-–±–∞“ì–∞–ª–∞—É + –∫–µ—Ä—ñ –±–∞–π–ª–∞–Ω—ã—Å + –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è</h1>
    <p>
      –ë“±–ª –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–¥–∞ —Å–µ–Ω –∞–ª–¥—ã–º–µ–Ω <b>–º–∏–Ω–∏-—Ç–µ—Å—Ç</b> –∂”ô–Ω–µ <b>‚Äú“ö–∞—Ç–µ “õ–∞–π–¥–∞?‚Äù</b> —Ç–∞–ø—Å—ã—Ä–º–∞—Å—ã–Ω –æ—Ä—ã–Ω–¥–∞–π—Å—ã“£.
      –ö–µ–π—ñ–Ω —Ç”©–º–µ–Ω–¥–µ <b>–∫—Ä–æ—Å—Å–≤–æ—Ä–¥</b> —à–µ—à–µ—Å—ñ“£. –ë–∞—Ä–ª—ã“ì—ã –∞–≤—Ç–æ–º–∞—Ç –±–∞“ì–∞–ª–∞–Ω—ã–ø, –¥–µ“£–≥–µ–π/–±–µ–π–¥–∂ —à—ã“ì–∞–¥—ã.
      –°–æ“£—ã–Ω–¥–∞ ‚Äú–†–µ—Ñ–ª–µ–∫—Å–∏—è‚Äù –±–µ—Ç—ñ–Ω–µ ”©—Ç—ñ–ø, –µ—Ä–µ–∫—à–µ —Ä–µ—Ñ–ª–µ–∫—Å–∏—è —Ç–æ–ª—Ç—ã—Ä–∞—Å—ã“£.
    </p>
  </section>

  <div class="grid" id="tasks">

    <!-- LEFT -->
    <section class="card">
      <h2>1) –ú–∏–Ω–∏-—Ç–µ—Å—Ç (–∞–≤—Ç–æ–º–∞—Ç—Ç—ã —Ç–µ–∫—Å–µ—Ä—ñ–ª–µ–¥—ñ)</h2>
      <p class="muted">–ú–∞“õ—Å–∞—Ç: –Ω–µ–≥—ñ–∑–≥—ñ “±“ì—ã–º–¥–∞—Ä–¥—ã –∂—ã–ª–¥–∞–º —Ç–µ–∫—Å–µ—Ä—É (8.4.3.1‚Äì8.4.3.3).</p>

      <div class="q" data-q="1">
        <div><b>1.</b> –ö“Ø—à —Å—ã–∑—ã“õ—Ç–∞—Ä—ã —Å—ã—Ä—Ç“õ—ã –∫–µ“£—ñ—Å—Ç—ñ–∫—Ç–µ “õ–∞–π –±–∞“ì—ã—Ç—Ç–∞ –±–æ–ª–∞–¥—ã?</div>
        <label><input type="radio" name="q1" value="a"> S ‚Üí N</label>
        <label><input type="radio" name="q1" value="b"> N ‚Üí S</label>
        <label><input type="radio" name="q1" value="c"> –ñ–æ“õ, –±–∞“ì—ã—Ç—ã –±–æ–ª–º–∞–π–¥—ã</label>
        <label><input type="radio" name="q1" value="d"> –ö–µ–∑ –∫–µ–ª–≥–µ–Ω –±–∞“ì—ã—Ç—Ç–∞</label>
      </div>

      <div class="q" data-q="2">
        <div><b>2.</b> “∞“õ—Å–∞—Å –ø–æ–ª—é—Å—Ç–µ—Ä “õ–∞–ª–∞–π ”ô—Å–µ—Ä–ª–µ—Å–µ–¥—ñ?</div>
        <label><input type="radio" name="q2" value="a"> –¢–∞—Ä—Ç—ã–ª–∞–¥—ã</label>
        <label><input type="radio" name="q2" value="b"> –¢–µ–±—ñ–ª–µ–¥—ñ</label>
        <label><input type="radio" name="q2" value="c"> ”ò—Å–µ—Ä–ª–µ—Å–ø–µ–π–¥—ñ</label>
        <label><input type="radio" name="q2" value="d"> –¢–µ–∫ “õ—ã–∑–¥—ã—Ä—Å–∞ ”ô—Å–µ—Ä–ª–µ—Å–µ–¥—ñ</label>
      </div>

      <div class="q" data-q="3">
        <div><b>3.</b> –ö“Ø—à —Å—ã–∑—ã“õ—Ç–∞—Ä—ã–Ω—ã“£ ‚Äú—Ç—ã“ì—ã–∑‚Äù –æ—Ä–Ω–∞–ª–∞—Å—É—ã –Ω–µ–Ω—ñ –±—ñ–ª–¥—ñ—Ä–µ–¥—ñ?</div>
        <label><input type="radio" name="q3" value="a"> ”®—Ä—ñ—Å ”ô–ª—Å—ñ–∑</label>
        <label><input type="radio" name="q3" value="b"> ”®—Ä—ñ—Å –∫“Ø—à—Ç—ñ—Ä–µ–∫</label>
        <label><input type="radio" name="q3" value="c"> –ú–∞–≥–Ω–∏—Ç –∂–æ“õ</label>
        <label><input type="radio" name="q3" value="d"> –ë“±–ª —Ç–µ–∫ —Å—É—Ä–µ—Ç “Ø—à—ñ–Ω</label>
      </div>

      <div class="row">
        <button class="btn primary" id="btnCheck">–¢–µ–∫—Å–µ—Ä—É</button>
        <button class="btn" id="btnReset">“ö–∞–π—Ç–∞ –±–∞—Å—Ç–∞—É</button>
        <span class="pill">–¢–µ—Å—Ç “±–ø–∞–π—ã: <b id="testScore">0</b>/30</span>
      </div>

      <div class="hr"></div>

      <h2>2) “ö–ë —Ç–∞–ø—Å—ã—Ä–º–∞—Å—ã: ‚Äú“ö–∞—Ç–µ “õ–∞–π–¥–∞?‚Äù</h2>
      <p class="muted">–¢”©–º–µ–Ω–¥–µ–≥—ñ —Ç“±–∂—ã—Ä—ã–º–¥–∞—Ä–¥—ã –±–∞“ì–∞–ª–∞–ø, “õ–∞—Ç–µ –±–æ–ª—Å–∞ ‚Äî –¥“±—Ä—ã—Å—ã–Ω –∂–∞–∑.</p>

      <div class="q">
        <label>–∞) ‚Äú–ú–∞–≥–Ω–∏—Ç—Ç—ñ “õ–∞“õ –±”©–ª—Å–µ, —Ç–µ–∫ N –ø–æ–ª—é—Å—ñ –±–∞—Ä –±”©–ª—ñ–∫ —à—ã“ì–∞–¥—ã.‚Äù (–¥“±—Ä—ã—Å—ã?)</label>
        <input type="text" id="fixA" placeholder="–ú—ã—Å–∞–ª—ã: ”ô—Ä –±”©–ª—ñ–∫ –∂–∞“£–∞ –º–∞–≥–Ω–∏—Ç –±–æ–ª–∞–¥—ã, –µ–∫–µ—É—ñ–Ω–¥–µ –¥–µ N –∂”ô–Ω–µ S –±–∞—Ä" />

        <label class="hint">–±) ‚Äú–°—ã—Ä—Ç“õ—ã –∫–µ“£—ñ—Å—Ç—ñ–∫—Ç–µ –∫“Ø—à —Å—ã–∑—ã“õ—Ç–∞—Ä—ã N‚ÜíS.‚Äù</label>
        <select id="fixB">
          <option value="">–¢–∞“£–¥–∞‚Ä¶</option>
          <option value="true">–î“±—Ä—ã—Å</option>
          <option value="false">“ö–∞—Ç–µ</option>
        </select>

        <label class="hint">–≤) ‚Äú“∞“õ—Å–∞—Å –ø–æ–ª—é—Å—Ç–µ—Ä —Ç–µ–±—ñ–ª–µ–¥—ñ.‚Äù</label>
        <select id="fixC">
          <option value="">–¢–∞“£–¥–∞‚Ä¶</option>
          <option value="true">–î“±—Ä—ã—Å</option>
          <option value="false">“ö–∞—Ç–µ</option>
        </select>

        <label class="hint">–≥) ‚Äú–ö“Ø—à —Å—ã–∑—ã“õ—Ç–∞—Ä—ã “õ–∏—ã–ª—ã—Å–∞ –∞–ª–∞–¥—ã.‚Äù (–¥“±—Ä—ã—Å—ã?)</label>
        <input type="text" id="fixD" placeholder="–ú—ã—Å–∞–ª—ã: –∫“Ø—à —Å—ã–∑—ã“õ—Ç–∞—Ä—ã “õ–∏—ã–ª—ã—Å–ø–∞–π–¥—ã" />
      </div>

      <div class="row">
        <button class="btn primary" id="btnCheckTask">–¢–∞–ø—Å—ã—Ä–º–∞–Ω—ã –±–∞“ì–∞–ª–∞—É</button>
        <span class="pill">–¢–∞–ø—Å—ã—Ä–º–∞ “±–ø–∞–π—ã: <b id="taskScore">0</b>/30</span>
      </div>

      <div class="hr"></div>

      <h2>3) –ö—Ä–æ—Å—Å–≤–æ—Ä–¥ (“ö–ë-–Ω—ñ“£ —à—ã“ì–∞—Ä–º–∞—à—ã–ª—ã“õ –±”©–ª—ñ–≥—ñ)</h2>
      <p class="muted" id="crossword">
        –¢”©–º–µ–Ω–¥–µ–≥—ñ –∫—Ä–æ—Å—Å–≤–æ—Ä–¥ —Å”©–∑–¥–µ—Ä—ñ–Ω —Ç–æ–ª—Ç—ã—Ä. ‚Äú–¢–µ–∫—Å–µ—Ä—É‚Äù –±–∞—Å“õ–∞–Ω–¥–∞ –∞–≤—Ç–æ–º–∞—Ç “±–ø–∞–π —à—ã“ì–∞–¥—ã.
        –ë“±–ª ‚Äî —Å–µ–Ω—ñ“£ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—Ç–∞–Ω —Ç—ã—Å —ç–ª–µ–º–µ–Ω—Ç—ñ“£: —Ü–∏—Ñ—Ä–ª—ã“õ –æ–π—ã–Ω + –∞–≤—Ç–æ-–±–∞“ì–∞–ª–∞—É.
      </p>

      <!-- –ö–†–û–°–°–í–û–†–î -->
      <div class="cw-wrap">
        <div class="cw-head">
          <div>
            <h3>–ö—Ä–æ—Å—Å–≤–æ—Ä–¥: ‚Äú–¢“±—Ä–∞“õ—Ç—ã –º–∞–≥–Ω–∏—Ç—Ç–µ—Ä‚Äù</h3>
            <div class="small">–ö–µ“£–µ—Å: —Å”©–∑–¥–µ—Ä–¥—ñ“£ –±”ô—Ä—ñ —Ç–∞“õ—ã—Ä—ã–ø —Ç–µ—Ä–º–∏–Ω–¥–µ—Ä—ñ. “∞—è—à—ã“õ“õ–∞ 1 ”ô—Ä—ñ–ø.</div>
          </div>
          <span class="pill">–ö—Ä–æ—Å—Å–≤–æ—Ä–¥ “±–ø–∞–π—ã: <b id="cwScore">0</b>/40</span>
        </div>

        <div id="cwGrid" class="cw-grid" aria-label="Crossword grid"></div>

        <div class="cw-cols">
          <div class="cw-col">
            <h4>‚Üí –ö”©–ª–¥–µ–Ω–µ“£</h4>
            <div id="cwAcross"></div>
          </div>
          <div class="cw-col">
            <h4>‚Üì –¢—ñ–∫</h4>
            <div id="cwDown"></div>
          </div>
        </div>

        <div class="cw-actions">
          <button class="btn primary" id="cwCheck">–¢–µ–∫—Å–µ—Ä—É</button>
          <button class="btn" id="cwReveal">–ñ–∞—É–∞–±—ã–Ω –∫”©—Ä—Å–µ—Ç</button>
          <button class="btn danger" id="cwReset">–¢–∞–∑–∞–ª–∞—É</button>
        </div>
        <div id="cwMsg" class="cw-result"></div>
      </div>

    </section>

    <!-- RIGHT -->
    <aside class="card">
      <h2>–ù”ô—Ç–∏–∂–µ + –∫–µ—Ä—ñ –±–∞–π–ª–∞–Ω—ã—Å</h2>

      <div class="row" style="justify-content:space-between;align-items:baseline">
        <div>
          <div class="muted">–ñ–∞–ª–ø—ã “±–ø–∞–π (–æ—Å—ã –±–µ—Ç)</div>
          <div class="scoreBig" id="totalScore">0</div>
          <div class="muted">/ 100 (—Ç–µ—Å—Ç 30 + “õ–∞—Ç–µ 30 + –∫—Ä–æ—Å—Å–≤–æ—Ä–¥ 40)</div>
        </div>
        <div id="levelTag" class="tag bad">–ë–∞—Å—Ç–∞—É</div>
      </div>

      <div class="hr"></div>

      <h2>Traffic light (”©–∑—ñ–Ω-”©–∑—ñ –±–∞“ì–∞–ª–∞—É)</h2>
      <p class="muted">–û“õ—É—à—ã ”©–∑—ñ —Ç–∞“£–¥–∞–π–¥—ã ‚Äî –∞–ª –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –Ω–∞“õ—Ç—ã –∫–µ“£–µ—Å –±–µ—Ä–µ–¥—ñ.</p>
      <select id="traffic">
        <option value="">–¢–∞“£–¥–∞‚Ä¶</option>
        <option value="green">üü¢ –¢“Ø—Å—ñ–Ω–¥—ñ–º</option>
        <option value="yellow">üü° –ñ–∞—Ç—Ç—ã“ì—É –∫–µ—Ä–µ–∫</option>
        <option value="red">üî¥ “ö–∏–Ω–∞–ª–¥—ã–º</option>
      </select>
      <p class="muted" id="trafficAdvice" style="margin-top:10px;"></p>

      <div class="hr"></div>

      <h2>–†—É–±—Ä–∏–∫–∞ –±–æ–π—ã–Ω—à–∞ “õ—ã—Å“õ–∞ —Ñ–∏–¥–±–µ–∫ (–∞–≤—Ç–æ–º–∞—Ç—Ç—ã)</h2>
      <div class="badges" id="rubricBox"></div>

      <div class="hr"></div>

      <h2>–ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è: –±–µ–π–¥–∂–¥–µ—Ä</h2>
      <p class="muted">“∞–ø–∞–π“ì–∞ “õ–∞—Ä–∞–π –±–µ–π–¥–∂ –∞—à—ã–ª–∞–¥—ã.</p>
      <div class="badges" id="badgeBox"></div>

      <div class="hr"></div>

      <div class="row">
        <button class="btn" id="btnToReflection">–†–µ—Ñ–ª–µ–∫—Å–∏—è –±–µ—Ç—ñ–Ω–µ ”©—Ç—É ‚Üí</button>
        <button class="btn primary" id="btnExport">–ù”ô—Ç–∏–∂–µ–Ω—ñ –∫”©—à—ñ—Ä—É</button>
      </div>
      <p class="small" id="exportText" style="white-space:pre-wrap;margin-top:10px;"></p>

      <div class="hr"></div>
      <p class="small">–ï—Å–∫–µ—Ä—Ç—É: –±”ô—Ä—ñ –±—Ä–∞—É–∑–µ—Ä–¥–µ —Å–∞“õ—Ç–∞–ª–∞–¥—ã (localStorage). –ò–Ω—Ç–µ—Ä–Ω–µ—Ç—Å—ñ–∑ –¥–µ –∂“±–º—ã—Å —ñ—Å—Ç–µ–π–¥—ñ.</p>
    </aside>

  </div>
</main>

<script>
/* ============================================================================
   1-–ë–ï–¢ –õ–û–ì–ò–ö–ê: –¢–µ—Å—Ç + “ö–ë + –ö—Ä–æ—Å—Å–≤–æ—Ä–¥ + –§–∏–¥–±–µ–∫
   ============================================================================ */

  // ‚îÄ‚îÄ‚îÄ –¢–ï–°–¢ –ö–õ–Æ–ß–ò ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const KEY_TEST = { q1:"b", q2:"b", q3:"b" };

  // ‚îÄ‚îÄ‚îÄ STATE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const state = {
    testScore: 0,   // /30
    taskScore: 0,   // /30
    cwScore: 0,     // /40
    reflectionsSaved: 0
  };

  const $ = (id) => document.getElementById(id);
  const clamp = (x,min,max)=>Math.max(min,Math.min(max,x));

  function computeTotal(){
    const total = state.testScore + state.taskScore + state.cwScore; // /100
    $("totalScore").textContent = total;
    $("cwScore").textContent = state.cwScore;
    updateLevel(total);
    updateRubric(total);
    updateBadges(total);
    saveToStorage();
  }

  function updateLevel(total){
    const tag = $("levelTag");
    if(total >= 85){ tag.className="tag ok"; tag.textContent="–ñ–æ“ì–∞—Ä—ã –¥–µ“£–≥–µ–π"; }
    else if(total >= 60){ tag.className="tag warn"; tag.textContent="–û—Ä—Ç–∞ –¥–µ“£–≥–µ–π"; }
    else { tag.className="tag bad"; tag.textContent="–ë–∞—Å—Ç–∞–ø“õ—ã –¥–µ“£–≥–µ–π"; }
  }

  function makeBadge(text){
    const div = document.createElement("div");
    div.className = "badge";
    div.innerHTML = `<div>${text}</div><div class="small">—Ñ–∏–¥–±–µ–∫</div>`;
    return div;
  }

  function updateRubric(total){
    const box = $("rubricBox");
    box.innerHTML = "";

    // –ö1 ‚Äî “±“ì—ã–º–¥–∞—Ä (—Ç–µ—Å—Ç)
    const k1 = state.testScore >= 20 ? "‚úÖ" : (state.testScore >= 12 ? "‚ö†Ô∏è" : "‚ùó");
    const msg1 = state.testScore >= 20
      ? "–ö1: “∞“ì—ã–º–¥–∞—Ä–¥—ã –∂–∞“õ—Å—ã –º–µ“£–≥–µ—Ä–≥–µ–Ω."
      : state.testScore >= 12
        ? "–ö1: “∞“ì—ã–º–¥–∞—Ä–¥–∞ –∞–∑–¥–∞–ø —à–∞—Ç–∞—Å—É –±–∞—Ä ‚Äî –∞–Ω—ã“õ—Ç–∞–º–∞–ª–∞—Ä–¥—ã “õ–∞–π—Ç–∞–ª–∞."
        : "–ö1: –ù–µ–≥—ñ–∑–≥—ñ “±“ì—ã–º–¥–∞—Ä–¥—ã “õ–∞–π—Ç–∞ “õ–∞—Ä–∞ (–º–∞–≥–Ω–∏—Ç ”©—Ä—ñ—Å—ñ, –ø–æ–ª—é—Å, –∫“Ø—à —Å—ã–∑—ã“õ—Ç–∞—Ä—ã).";

    // –ö2‚Äì–ö3 ‚Äî “õ–∞—Å–∏–µ—Ç/—Å—ã–∑—ã“õ (“õ–∞—Ç–µ —Ç“Ø–∑–µ—Ç—É)
    const k23 = state.taskScore >= 22 ? "‚úÖ" : (state.taskScore >= 14 ? "‚ö†Ô∏è" : "‚ùó");
    const msg2 = state.taskScore >= 22
      ? "–ö2‚Äì–ö3: “ö–∞—Å–∏–µ—Ç—Ç–µ—Ä –º–µ–Ω –∫“Ø—à —Å—ã–∑—ã“õ—Ç–∞—Ä—ã–Ω –¥“±—Ä—ã—Å —Ç“Ø—Å—ñ–Ω–¥—ñ—Ä–µ–¥—ñ."
      : state.taskScore >= 14
        ? "–ö2‚Äì–ö3: –ë–∞“ì—ã—Ç/“õ–∞—Å–∏–µ—Ç –±–æ–π—ã–Ω—à–∞ 1‚Äì2 “õ–∞—Ç–µ –±–∞—Ä ‚Äî N‚ÜíS –±–∞“ì—ã—Ç—ã–Ω –µ—Å—Ç–µ —Å–∞“õ—Ç–∞."
        : "–ö2‚Äì–ö3: –ü–æ–ª—é—Å—Ç–µ—Ä ”ô—Å–µ—Ä–ª–µ—Å—É—ñ –∂”ô–Ω–µ –∫“Ø—à —Å—ã–∑—ã“õ—Ç–∞—Ä—ã–Ω—ã“£ “õ–∏—ã–ª—ã—Å–ø–∞–π—Ç—ã–Ω—ã–Ω “õ–∞–π—Ç–∞–ª–∞—É –∫–µ—Ä–µ–∫.";

    // –ö—Ä–æ—Å—Å–≤–æ—Ä–¥ ‚Äî —Ç–µ—Ä–º–∏–Ω–¥–µ—Ä –±–µ–∫—ñ—Ç—É
    const kc = state.cwScore >= 32 ? "‚úÖ" : (state.cwScore >= 22 ? "‚ö†Ô∏è" : "‚ùó");
    const msgC = state.cwScore >= 32
      ? "–¢–µ—Ä–º–∏–Ω–¥–µ—Ä: –ö—Ä–æ—Å—Å–≤–æ—Ä–¥—Ç–∞ –∫”©–ø —Å”©–∑ –¥“±—Ä—ã—Å ‚Äî ”©—Ç–µ –∂–∞“õ—Å—ã –±–µ–∫—ñ—Ç—Ç—ñ“£."
      : state.cwScore >= 22
        ? "–¢–µ—Ä–º–∏–Ω–¥–µ—Ä: –ë—ñ—Ä–Ω–µ—à–µ —Å”©–∑–¥–µ “õ–∞—Ç–µ –±–∞—Ä ‚Äî –∞–Ω—ã“õ—Ç–∞–º–∞–ª–∞—Ä–¥—ã “õ–∞—Ä–∞–ø “õ–∞–π—Ç–∞–ª–∞."
        : "–¢–µ—Ä–º–∏–Ω–¥–µ—Ä: –ö—Ä–æ—Å—Å–≤–æ—Ä–¥ “õ–∏—ã–Ω –±–æ–ª–¥—ã ‚Äî —Å”©–∑–¥—ñ–∫–ø–µ–Ω –±—ñ—Ä–≥–µ “õ–∞–π—Ç–∞ –æ—Ä—ã–Ω–¥–∞.";

    // –ö4 ‚Äî –¥”ô–ª–µ–ª–¥–µ—É: traffic + –∫–µ–π—ñ–Ω–≥—ñ —Ä–µ—Ñ–ª–µ–∫—Å–∏—è“ì–∞ –¥–∞–π—ã–Ω–¥—ã“õ
    const traffic = $("traffic").value;
    let k4icon = traffic ? "‚úÖ" : "‚ö†Ô∏è";
    let k4msg = traffic
      ? "–ö4: ”®–∑—ñ–Ω-”©–∑—ñ –±–∞“ì–∞–ª–∞—É —Ç–∞“£–¥–∞–¥—ã“£. –ï–Ω–¥—ñ —Ä–µ—Ñ–ª–µ–∫—Å–∏—è –±–µ—Ç—ñ–Ω–µ ”©—Ç—ñ–ø –æ–π—ã“£–¥—ã –∂–∏–Ω–∞“õ—Ç–∞."
      : "–ö4: Traffic light —Ç–∞“£–¥–∞ ‚Äî –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –Ω–∞“õ—Ç—ã –∫–µ“£–µ—Å –±–µ—Ä–µ–¥—ñ.";

    box.appendChild(makeBadge(`${k1} ${msg1}`));
    box.appendChild(makeBadge(`${k23} ${msg2}`));
    box.appendChild(makeBadge(`${kc} ${msgC}`));
    box.appendChild(makeBadge(`${k4icon} ${k4msg}`));
  }

  function updateBadges(total){
    const box = $("badgeBox");
    box.innerHTML = "";

    const badges = [
      {name:"Field Starter", need: 30, desc:"–ù–µ–≥—ñ–∑–≥—ñ “±“ì—ã–º–¥–∞—Ä–¥—ã –∂–∏–Ω–∞–¥—ã“£"},
      {name:"Pole Master", need: 55, desc:"–ü–æ–ª—é—Å—Ç–µ—Ä/“õ–∞—Å–∏–µ—Ç—Ç–µ—Ä–¥—ñ –∂–∞“õ—Å—ã –±—ñ–ª–µ—Å—ñ“£"},
      {name:"Line Navigator", need: 70, desc:"–ö“Ø—à —Å—ã–∑—ã“õ—Ç–∞—Ä—ã –º–µ–Ω –±–∞“ì—ã—Ç—Ç—ã –º–µ“£–≥–µ—Ä–¥—ñ“£"},
      {name:"Magnet Pro", need: 85, desc:"–ñ–æ“ì–∞—Ä—ã –¥–µ“£–≥–µ–π! –ñ–∞—Ä–∞–π—Å—ã“£!"}
    ];

    badges.forEach(b=>{
      const unlocked = total >= b.need;
      const div = document.createElement("div");
      div.className="badge";
      div.innerHTML = `
        <div>
          <b>${unlocked ? "üèÖ" : "üîí"} ${b.name}</b>
          <div class="small">${b.desc} (“õ–∞–∂–µ—Ç: ${b.need}/100)</div>
        </div>
        <div class="tag ${unlocked ? "ok":"bad"}">${unlocked ? "–ê—à—ã–ª–¥—ã":"–ñ–∞–±—ã“õ"}</div>
      `;
      box.appendChild(div);
    });
  }

  function saveToStorage(){
    localStorage.setItem("edu_magnet_state", JSON.stringify({
      ...state,
      traffic: $("traffic").value
    }));
  }

  function loadFromStorage(){
    const raw = localStorage.getItem("edu_magnet_state");
    if(!raw) return;
    try{
      const s = JSON.parse(raw);
      state.testScore = s.testScore ?? 0;
      state.taskScore = s.taskScore ?? 0;
      state.cwScore = s.cwScore ?? 0;
      state.reflectionsSaved = s.reflectionsSaved ?? 0;
      $("testScore").textContent = state.testScore;
      $("taskScore").textContent = state.taskScore;
      $("cwScore").textContent = state.cwScore;
      $("traffic").value = s.traffic ?? "";
      computeTotal();
      updateTrafficAdvice();
    }catch(e){}
  }

  // ‚îÄ‚îÄ‚îÄ –¢–ï–°–¢ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  $("btnCheck").addEventListener("click", ()=>{
    let score = 0;
    for(const q of [1,2,3]){
      const chosen = document.querySelector(`input[name="q${q}"]:checked`)?.value;
      if(chosen && chosen === KEY_TEST["q"+q]) score += 10;
    }
    state.testScore = score;
    $("testScore").textContent = score;
    computeTotal();
  });

  // ‚îÄ‚îÄ‚îÄ –°–ë–†–û–° ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  $("btnReset").addEventListener("click", ()=>{
    document.querySelectorAll('input[type="radio"]').forEach(r=>r.checked=false);
    $("fixA").value=""; $("fixB").value=""; $("fixC").value=""; $("fixD").value="";
    $("traffic").value="";
    state.testScore=0; state.taskScore=0; state.cwScore=0;
    $("testScore").textContent="0"; $("taskScore").textContent="0"; $("cwScore").textContent="0";
    $("exportText").textContent="";
    $("trafficAdvice").textContent="";
    // –∫—Ä–æ—Å—Å–≤–æ—Ä–¥ —Ç–æ–∂–µ –æ—á–∏—Å—Ç–∏–º
    cwReset();
    localStorage.removeItem("edu_magnet_state");
    computeTotal();
  });

  // ‚îÄ‚îÄ‚îÄ ‚Äú“ö–ê–¢–ï “ö–ê–ô–î–ê?‚Äù ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  $("btnCheckTask").addEventListener("click", ()=>{
    let score = 0;

    const a = $("fixA").value.toLowerCase();
    const aOk = a.includes("–µ–∫–µ—É") || a.includes("–µ–∫—ñ") || a.includes("”ô—Ä") || a.includes("–∂–∞“£–∞") || (a.includes("n") && a.includes("s"));
    if(a.length >= 15 && aOk) score += 10;

    if($("fixB").value === "true") score += 8;
    if($("fixC").value === "true") score += 6;

    const d = $("fixD").value.toLowerCase();
    const dOk = d.includes("“õ–∏—ã–ª—ã—Å–ø") || d.includes("–ø–µ—Ä–µ—Å–µ–∫") || d.includes("“õ–∏—ã–ª—ã—Å–ø–∞–π–¥—ã");
    if(d.length >= 10 && dOk) score += 6;

    score = clamp(score,0,30);
    state.taskScore = score;
    $("taskScore").textContent = score;
    computeTotal();
  });

  // ‚îÄ‚îÄ‚îÄ TRAFFIC LIGHT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  $("traffic").addEventListener("change", updateTrafficAdvice);

  function updateTrafficAdvice(){
    const v = $("traffic").value;
    let t = "";
    if(v === "green") t = "üü¢ –ö–µ—Ä–µ–º–µ—Ç! –ï–Ω–¥—ñ: N‚ÜíS –±–∞“ì—ã—Ç—ã–Ω –∂”ô–Ω–µ ‚Äò—Ç—ã“ì—ã–∑–¥—ã“õ = ”©—Ä—ñ—Å –∫“Ø—à—Ç—ñ‚Äô “õ–∞“ì–∏–¥–∞—Å—ã–Ω 1 –º—ã—Å–∞–ª–º–µ–Ω –±–µ–∫—ñ—Ç.";
    if(v === "yellow") t = "üü° –ñ–∞—Ç—Ç—ã“ì—É: 5 —Ç–µ–∑ —Å“±—Ä–∞“õ (N/S ”ô—Å–µ—Ä–ª–µ—Å—É—ñ). –°–æ—Å—ã–Ω –∫—Ä–æ—Å—Å–≤–æ—Ä–¥—Ç—ã “õ–∞–π—Ç–∞ —Ç–µ–∫—Å–µ—Ä.";
    if(v === "red") t = "üî¥ “ö–∞–¥–∞–º–¥–∞–ø: 1) –∞–Ω—ã“õ—Ç–∞–º–∞; 2) N‚ÜíS –±–∞“ì—ã—Ç—ã; 3) –∫—Ä–æ—Å—Å–≤–æ—Ä–¥—Ç–∞ 2 —Å”©–∑–¥—ñ —Ç“Ø–∑–µ—Ç.";
    $("trafficAdvice").textContent = t;
    computeTotal();
  }

  // ‚îÄ‚îÄ‚îÄ EXPORT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  $("btnExport").addEventListener("click", ()=>{
    const total = state.testScore + state.taskScore + state.cwScore;
    const traffic = $("traffic").value || "—Ç–∞“£–¥–∞–ª–º–∞–¥—ã";
    const text =
`EduPhysics AI ‚Äî “ö–ë –ù”ò–¢–ò–ñ–ï
–¢–∞“õ—ã—Ä—ã–ø: –¢“±—Ä–∞“õ—Ç—ã –º–∞–≥–Ω–∏—Ç—Ç–µ—Ä
–ñ–∞–ª–ø—ã: ${total}/100
- –ú–∏–Ω–∏-—Ç–µ—Å—Ç: ${state.testScore}/30
- ‚Äú“ö–∞—Ç–µ “õ–∞–π–¥–∞?‚Äù: ${state.taskScore}/30
- –ö—Ä–æ—Å—Å–≤–æ—Ä–¥: ${state.cwScore}/40
Traffic light: ${traffic}
–ö–µ—Ä—ñ –±–∞–π–ª–∞–Ω—ã—Å:
${$("trafficAdvice").textContent || "‚Äî"}`;

    $("exportText").textContent = text;
    navigator.clipboard?.writeText(text).catch(()=>{});
  });

  $("btnToReflection").addEventListener("click", ()=>{
    // –†–µ—Ñ–ª–µ–∫—Å–∏—è –±–µ—Ç—ñ–Ω–µ ”©—Ç–ø–µ—Å –±“±—Ä—ã–Ω –∞“ì—ã–º–¥–∞“ì—ã –±–∞–ª–ª–¥–∞—Ä–¥—ã —Å–∞“õ—Ç–∞–ø –∫–µ—Ç–µ–º—ñ–∑
    saveToStorage();
    window.location.href = "reflection.html";
  });

/* ============================================================================
   –ö–†–û–°–°–í–û–†–î (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π) ‚Äî —Å–µ–Ω –±–µ—Ä–≥–µ–Ω –ª–æ–≥–∏–∫–∞“ì–∞ –Ω–µ–≥—ñ–∑–¥–µ–ª–≥–µ–Ω
   ============================================================================
   “∞–ø–∞–π–ª–∞—É: –¥“±—Ä—ã—Å ”ô—Ä—ñ–ø—Ç–µ—Ä / –∂–∞–ª–ø—ã ”ô—Ä—ñ–ø—Ç–µ—Ä * 40 (–¥”©“£–≥–µ–ª–µ–∫—Ç–µ—É)
   ============================================================================ */

  const CW_WORDS = [
    // ACROSS
    { id: 1, dir: 'across', row: 0, col: 0, answer: '–ú–ê–ì–ù–ò–¢',   clue: '–¢–µ–º—ñ—Ä–¥—ñ —Ç–∞—Ä—Ç–∞—Ç—ã–Ω —Ç–∞–±–∏“ì–∏ –Ω–µ–º–µ—Å–µ –∂–∞—Å–∞–Ω–¥—ã –∑–∞—Ç' },
    { id: 4, dir: 'across', row: 2, col: 1, answer: '–ü–û–õ–Æ–°',    clue: '–ú–∞–≥–Ω–∏—Ç—Ç—ñ“£ –µ“£ –∫“Ø—à—Ç—ñ –±”©–ª—ñ–≥—ñ (–°–æ–ª—Ç“Ø—Å—Ç—ñ–∫ –∂”ô–Ω–µ –û“£—Ç“Ø—Å—Ç—ñ–∫)' },
    { id: 6, dir: 'across', row: 4, col: 0, answer: '–¢–ê–†–¢–£',    clue: '“ö–∞—Ä–∞–º–∞-“õ–∞—Ä—Å—ã –ø–æ–ª—é—Å—Ç–µ—Ä –∞—Ä–∞—Å—ã–Ω–¥–∞“ì—ã ”©–∑–∞—Ä–∞ ”ô—Å–µ—Ä' },
    { id: 7, dir: 'across', row: 6, col: 2, answer: '”®–†–Ü–°',     clue: '–ú–∞–≥–Ω–∏—Ç—Ç—ñ“£ –∞–π–Ω–∞–ª–∞—Å—ã–Ω–¥–∞“ì—ã –∫“Ø—à ”ô—Å–µ—Ä –µ—Ç–µ—Ç—ñ–Ω –∫–µ“£—ñ—Å—Ç—ñ–∫' },
    { id: 9, dir: 'across', row: 8, col: 0, answer: '–ö–û–ú–ü–ê–°',   clue: '–¢“±—Ä–∞“õ—Ç—ã –º–∞–≥–Ω–∏—Ç –Ω–µ–≥—ñ–∑—ñ–Ω–¥–µ–≥—ñ –±–∞“ì–¥–∞—Ä–ª–∞—É “õ“±—Ä–∞–ª—ã' },
    { id: 11,dir: 'across', row:10, col: 1, answer: '–¢–ï–ú–Ü–†',    clue: '–ú–∞–≥–Ω–∏—Ç —Ç–∞—Ä—Ç–∞—Ç—ã–Ω –Ω–µ–≥—ñ–∑–≥—ñ –º–µ—Ç–∞–ª–ª' },
    // DOWN
    { id: 2, dir: 'down',   row: 0, col: 3, answer: '–ú–ê–ì–ù–ò–¢–¢–Ü–ö', clue: '...”©—Ä—ñ—Å ‚Äî –º–∞–≥–Ω–∏—Ç —Ç—É–¥—ã—Ä–∞—Ç—ã–Ω –∫“Ø—à –∫–µ“£—ñ—Å—Ç—ñ–≥—ñ' },
    { id: 3, dir: 'down',   row: 0, col: 5, answer: '–ù–ò–ö–ï–õ–¨',   clue: '–ú–∞–≥–Ω–∏—Ç —Ç–∞—Ä—Ç–∞ –∞–ª–∞—Ç—ã–Ω –º–µ—Ç–∞–ª–ª, —Ö–∏–º–∏—è–ª—ã“õ –±–µ–ª–≥—ñ—Å—ñ Ni' },
    { id: 5, dir: 'down',   row: 2, col: 7, answer: '–ò–¢–ï–†–£',    clue: '–ë—ñ—Ä–¥–µ–π –ø–æ–ª—é—Å—Ç–µ—Ä –∞—Ä–∞—Å—ã–Ω–¥–∞“ì—ã ”©–∑–∞—Ä–∞ ”ô—Å–µ—Ä' },
    { id: 8, dir: 'down',   row: 4, col: 9, answer: '–§–ï–†–†–û',    clue: '...–º–∞–≥–Ω–µ—Ç–∏–∑–º ‚Äî —Ç–µ–º—ñ—Ä —Ç”ô—Ä—ñ–∑–¥—ñ –º–∞—Ç–µ—Ä–∏–∞–ª–¥–∞—Ä–¥—ã“£ “õ–∞—Å–∏–µ—Ç—ñ' },
    { id: 10,dir: 'down',   row: 6, col: 5, answer: '–ë–û–õ–ê–¢',    clue: '–¢“±—Ä–∞“õ—Ç—ã –º–∞–≥–Ω–∏—Ç –∂–∞—Å–∞–ª–∞—Ç—ã–Ω “õ–∞—Ç—Ç—ã –º–∞—Ç–µ—Ä–∏–∞–ª' }
  ];

  const CW_ROWS = 13, CW_COLS = 12;
  const cwGridArr = Array.from({length: CW_ROWS}, () => Array(CW_COLS).fill(null));

  // place letters
  CW_WORDS.forEach(w=>{
    for(let i=0;i<w.answer.length;i++){
      const r = w.dir==='across' ? w.row : w.row+i;
      const c = w.dir==='across' ? w.col+i : w.col;
      cwGridArr[r][c] = { letter: w.answer[i], num: null };
    }
  });
  // place numbers
  CW_WORDS.forEach(w=>{
    const r=w.row,c=w.col;
    if(cwGridArr[r][c]) cwGridArr[r][c].num = w.id;
  });

  // bounds
  let minR=CW_ROWS, maxR=0, minC=CW_COLS, maxC=0;
  for(let r=0;r<CW_ROWS;r++){
    for(let c=0;c<CW_COLS;c++){
      if(cwGridArr[r][c]){
        minR=Math.min(minR,r); maxR=Math.max(maxR,r);
        minC=Math.min(minC,c); maxC=Math.max(maxC,c);
      }
    }
  }

  const cwEl = $("cwGrid");
  const visRows = maxR - minR + 1;
  const visCols = maxC - minC + 1;
  cwEl.style.gridTemplateColumns = `repeat(${visCols}, auto)`;
  cwEl.style.gridTemplateRows = `repeat(${visRows}, auto)`;

  const cwInputMap = {}; // "r,c" -> input
  function cwGetCellEl(r,c){ return document.querySelector(`.cw-cell[data-r="${r}"][data-c="${c}"]`); }

  for(let r=minR;r<=maxR;r++){
    for(let c=minC;c<=maxC;c++){
      const cell=document.createElement("div");
      cell.className="cw-cell";
      if(cwGridArr[r][c]){
        cell.classList.add("active");
        cell.dataset.r = r;
        cell.dataset.c = c;

        if(cwGridArr[r][c].num){
          const n=document.createElement("span");
          n.className="num";
          n.textContent=cwGridArr[r][c].num;
          cell.appendChild(n);
        }

        const inp=document.createElement("input");
        inp.type="text";
        inp.maxLength=1;
        inp.autocomplete="off";
        inp.spellcheck=false;

        cell.appendChild(inp);
        cwInputMap[`${r},${c}`]=inp;

        inp.addEventListener("input", ()=>{
          const val = inp.value.toUpperCase().replace(/[^–ê-–Ø“í“ö“¢”®“∞“Æ–Ü–Å]/g,"");
          inp.value = val ? val[val.length-1] : "";
          if(inp.value) cwMoveNext(r,c);
        });

        inp.addEventListener("keydown", (e)=>{
          if(e.key==="Backspace" && !inp.value) cwMovePrev(r,c);
          if(e.key==="ArrowRight"){e.preventDefault(); cwFocus(r,c+1);}
          if(e.key==="ArrowLeft"){e.preventDefault(); cwFocus(r,c-1);}
          if(e.key==="ArrowDown"){e.preventDefault(); cwFocus(r+1,c);}
          if(e.key==="ArrowUp"){e.preventDefault(); cwFocus(r-1,c);}
        });

        inp.addEventListener("focus", ()=>{
          cwClearHL();
          cell.classList.add("selected");
          cwHighlightWord(r,c);
        });
      }
      cwEl.appendChild(cell);
    }
  }

  function cwFocus(r,c){
    const inp = cwInputMap[`${r},${c}`];
    if(inp) inp.focus();
  }
  function cwMoveNext(r,c){
    if(cwInputMap[`${r},${c+1}`]) return cwFocus(r,c+1);
    if(cwInputMap[`${r+1},${c}`]) return cwFocus(r+1,c);
  }
  function cwMovePrev(r,c){
    if(cwInputMap[`${r},${c-1}`]) return cwFocus(r,c-1);
    if(cwInputMap[`${r-1},${c}`]) return cwFocus(r-1,c);
  }
  function cwClearHL(){
    document.querySelectorAll(".cw-cell").forEach(x=>x.classList.remove("highlight","selected"));
  }
  function cwHighlightWord(r,c){
    CW_WORDS.forEach(w=>{
      for(let i=0;i<w.answer.length;i++){
        const wr = w.dir==='across' ? w.row : w.row+i;
        const wc = w.dir==='across' ? w.col+i : w.col;
        if(wr===r && wc===c){
          for(let j=0;j<w.answer.length;j++){
            const hr = w.dir==='across' ? w.row : w.row+j;
            const hc = w.dir==='across' ? w.col+j : w.col;
            const el = cwGetCellEl(hr,hc);
            if(el) el.classList.add("highlight");
          }
        }
      }
    });
  }

  // clues
  const across = $("cwAcross");
  const down = $("cwDown");
  function addClue(w, container){
    const div=document.createElement("div");
    div.className="cw-clue";
    div.innerHTML = `<span class="n">${w.id}</span><span class="t">${w.clue}</span>`;
    div.addEventListener("click", ()=>cwFocus(w.row,w.col));
    container.appendChild(div);
  }
  CW_WORDS.filter(w=>w.dir==="across").forEach(w=>addClue(w,across));
  CW_WORDS.filter(w=>w.dir==="down").forEach(w=>addClue(w,down));

  function cwComputeScore(){
    // count letters
    let total=0, correct=0;
    CW_WORDS.forEach(w=>{
      for(let i=0;i<w.answer.length;i++){
        const r = w.dir==='across' ? w.row : w.row+i;
        const c = w.dir==='across' ? w.col+i : w.col;
        const inp = cwInputMap[`${r},${c}`];
        const cell = cwGetCellEl(r,c);
        if(!inp) continue;
        total++;
        if(inp.value.toUpperCase() === w.answer[i]){
          correct++;
          cell?.classList.add("correct");
          cell?.classList.remove("wrong");
        }else if(inp.value){
          cell?.classList.add("wrong");
          cell?.classList.remove("correct");
        }else{
          cell?.classList.remove("wrong","correct");
        }
      }
    });

    // scale to /40
    const score = total ? Math.round((correct/total)*40) : 0;
    state.cwScore = clamp(score,0,40);
    $("cwScore").textContent = state.cwScore;

    const msg = $("cwMsg");
    if(correct===total && total>0){
      msg.className="cw-result ok";
      msg.textContent = "‚úì –ë–∞—Ä–ª—ã“ì—ã –¥“±—Ä—ã—Å! –ö–µ—Ä–µ–º–µ—Ç!";
    }else{
      msg.className="cw-result warn";
      msg.textContent = `${correct} / ${total} –¥“±—Ä—ã—Å ‚Ä¢ “∞–ø–∞–π: ${state.cwScore}/40`;
    }

    computeTotal();
  }

  function cwReveal(){
    CW_WORDS.forEach(w=>{
      for(let i=0;i<w.answer.length;i++){
        const r = w.dir==='across' ? w.row : w.row+i;
        const c = w.dir==='across' ? w.col+i : w.col;
        const inp = cwInputMap[`${r},${c}`];
        const cell = cwGetCellEl(r,c);
        if(inp){ inp.value = w.answer[i]; }
        cell?.classList.add("correct");
        cell?.classList.remove("wrong");
      }
    });
    state.cwScore = 40; // –µ—Å–ª–∏ –ø–æ–∫–∞–∑–∞–ª–∏ –æ—Ç–≤–µ—Ç—ã ‚Äî –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å 40 –∏–ª–∏ 0; –æ—Å—Ç–∞–≤–∏–º 40 –¢–û–õ–¨–ö–û –µ—Å–ª–∏ —É—á–∏—Ç–µ–ª—å —Ä–∞–∑—Ä–µ—à–∞–µ—Ç.
    // –•–æ—á–µ—à—å —á–µ—Å—Ç–Ω–µ–µ: –ø–æ—Å—Ç–∞–≤—å 0 –≤–º–µ—Å—Ç–æ 40.
    $("cwMsg").className="cw-result";
    $("cwMsg").textContent="–ñ–∞—É–∞–ø—Ç–∞—Ä –∫”©—Ä—Å–µ—Ç—ñ–ª–¥—ñ";
    $("cwScore").textContent = state.cwScore;
    computeTotal();
  }

  function cwReset(){
    Object.values(cwInputMap).forEach(inp=>inp.value="");
    document.querySelectorAll(".cw-cell").forEach(c=>c.classList.remove("correct","wrong","highlight","selected"));
    $("cwMsg").textContent="";
    state.cwScore = 0;
    $("cwScore").textContent="0";
    computeTotal();
  }

  $("cwCheck").addEventListener("click", cwComputeScore);
  $("cwReveal").addEventListener("click", cwReveal);
  $("cwReset").addEventListener("click", cwReset);

  // expose to outer reset
  window.cwReset = cwReset;

  // INIT
  loadFromStorage();
  computeTotal();
</script>
</body>
</html>
